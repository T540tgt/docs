"use strict";(self.webpackChunkdocs_oasis_io=self.webpackChunkdocs_oasis_io||[]).push([[5028],{7004:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>l});var o=i(4848),r=i(8453);const t={},s="IAS Proxy",a={id:"node/run-your-node/ias-proxy",title:"IAS Proxy",description:"This guide will cover setting up an Intel Attestation Service (IAS)",source:"@site/docs/node/run-your-node/ias-proxy.md",sourceDirName:"node/run-your-node",slug:"/node/run-your-node/ias-proxy",permalink:"/node/run-your-node/ias-proxy",draft:!1,unlisted:!1,editUrl:"https://github.com/oasisprotocol/docs/edit/main/docs/node/run-your-node/ias-proxy.md",tags:[],version:"current",lastUpdatedAt:1723018842e3,frontMatter:{},sidebar:"operators",previous:{title:"Upgrading Key Managers",permalink:"/node/run-your-node/keymanager-node/key-manager-upgrade"},next:{title:"Sentry Node",permalink:"/node/run-your-node/sentry-node"}},d={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Obtaining IAS Service Provider ID (SPID) and API Key",id:"obtaining-ias-service-provider-id-spid-and-api-key",level:3},{value:"Creating a Working Directory",id:"creating-a-working-directory",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Starting the IAS Proxy",id:"starting-the-ias-proxy",level:2},{value:"IAS Proxy Public Key",id:"ias-proxy-public-key",level:2},{value:"Share IAS Proxy address <a></a>",id:"share-ias-proxy-address-",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"ias-proxy",children:"IAS Proxy"}),"\n",(0,o.jsxs)(n.p,{children:["This guide will cover setting up an ",(0,o.jsx)(n.a,{href:"https://software.intel.com/content/www/us/en/develop/download/intel-sgx-intel-epid-provisioning-and-attestation-services.html",children:"Intel Attestation Service (IAS)"}),"\nProxy node for the Oasis Network. This guide assumes some basic knowledge on the\nuse of command line tools."]}),"\n",(0,o.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(n.p,{children:["Before following this guide, make sure you've followed the\n",(0,o.jsx)(n.a,{href:"prerequisites",children:"Prerequisites"})," section and have the Oasis Node binary installed\non your system. The IAS Proxy connects to an Oasis Node, so make sure you have a\nrunning node first. For more details, see the instructions on how to\n",(0,o.jsx)(n.a,{href:"/node/run-your-node/non-validator-node#configuration",children:"Run a Non-validator Node"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"obtaining-ias-service-provider-id-spid-and-api-key",children:"Obtaining IAS Service Provider ID (SPID) and API Key"}),"\n",(0,o.jsxs)(n.p,{children:["Running the ",(0,o.jsx)(n.a,{href:"https://software.intel.com/content/www/us/en/develop/download/intel-sgx-intel-epid-provisioning-and-attestation-services.html",children:"Intel Attestation Service (IAS)"}),"\nProxy requires access to the IAS API. Go to ",(0,o.jsx)(n.a,{href:"https://api.portal.trustedservices.intel.com/EPID-attestation",children:"IAS Enhanced Privacy ID (EPID) attestation"}),"\npage and signup for the ",(0,o.jsx)(n.em,{children:"Production Access"}),". As a service provider, you will\nregister your TLS certificate and obtain your Service Provider ID (SPID) and API\nkey. The SPID and API key will be used by the IAS Proxy to communicate with the\nIAS."]}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["Basic understanding of SGX Remote attestation is recommended. See Intel's\n",(0,o.jsx)(n.a,{href:"https://software.intel.com/content/www/us/en/develop/articles/code-sample-intel-software-guard-extensions-remote-attestation-end-to-end-example.html",children:"Remote Attestation End-to-End Example"}),"\nfor a short practical introduction."]})}),"\n",(0,o.jsx)(n.h3,{id:"creating-a-working-directory",children:"Creating a Working Directory"}),"\n",(0,o.jsxs)(n.p,{children:["We will be using the following working directory ",(0,o.jsx)(n.code,{children:"/node/ias"})," (feel free to name\nyour directory however you wish)."]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The directory permissions should be ",(0,o.jsx)(n.code,{children:"rwx------"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"To create the directory, use the following command:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:"mkdir -m700 -p /node/ias\n"})}),"\n",(0,o.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,o.jsx)(n.p,{children:"To avoid specifying the IAS Service Provider ID (SPID) and API key in the Oasis\nNode configuration directly, IAS Proxy supports reading the SPID and API key\nfrom environment variables. Make sure you have the following environment\nvariables set:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:'OASIS_IAS_SPID="<your-SPID>"\nOASIS_IAS_APIKEY="<your-API-key>"\n'})}),"\n",(0,o.jsxs)(n.p,{children:["In order to configure the IAS proxy create the ",(0,o.jsx)(n.code,{children:"/node/ias/config.yml"})," file with\nthe following content:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:"common:\n    data_dir: /node/ias\n    log:\n        format: JSON\n        level:\n            default: info\n"})}),"\n",(0,o.jsx)(n.h2,{id:"starting-the-ias-proxy",children:"Starting the IAS Proxy"}),"\n",(0,o.jsx)(n.p,{children:"You can start the IAS Proxy using the following command:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"oasis-node ias proxy \\\n  --config /node/ias/config.yml \\\n  --address unix:{{ oasis_node_socket }} \\\n  --ias.production true \\\n  --grpc.port 8650\n"})}),"\n",(0,o.jsx)(n.p,{children:"Before using this configuration you should collect the following information to\nreplace the  variables present in the invocation command:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"{{ oasis_node_socket }}"}),": Path to a running client Oasis Node socket."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"ias-proxy-public-key",children:"IAS Proxy Public Key"}),"\n",(0,o.jsx)(n.p,{children:"The TLS public key required for connecting to the IAS Proxy can be found in the\nprocess logs where it is output on startup as following:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{"caller":"proxy.go:111","level":"info","module":"cmd/ias/proxy","msg":"loaded/generated IAS TLS certificate","public_key":"tnTwXvGbbxqlFoirBDj63xWtZHS20Lb3fCURv0YDtYw=","ts":"2023-06-20T09:43:39.592787275Z"}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The relevant item is the ",(0,o.jsx)(n.code,{children:"public_key"})," which in the above case is\n",(0,o.jsx)(n.code,{children:"tnTwXvGbbxqlFoirBDj63xWtZHS20Lb3fCURv0YDtYw="}),"."]}),"\n",(0,o.jsxs)(n.h3,{id:"share-ias-proxy-address-",children:["Share IAS Proxy address ",(0,o.jsx)("a",{id:"share-seed-node-address"})]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"/node/run-your-node/paratime-node",children:"ParaTime nodes"})," can now use your IAS Proxy by specifying it\nin configuration, e.g.:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'ias:\n  proxy:\n    address:\n      - "<IAS_PROXY_PUBLIC_KEY>@<EXTERNAL_IP>:8650"\n'})}),"\n",(0,o.jsx)(n.p,{children:"Note that you can list multiple IAS proxy addresses."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>a});var o=i(6540);const r={},t=o.createContext(r);function s(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);