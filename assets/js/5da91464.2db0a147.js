"use strict";(self.webpackChunkdocs_oasis_io=self.webpackChunkdocs_oasis_io||[]).push([[4839],{4129:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var i=o(4848),s=o(8453);const r={description:"This page describes how to run an archive node on the Oasis Network."},t="Archive Node",a={id:"node/run-your-node/archive-node",title:"Archive Node",description:"This page describes how to run an archive node on the Oasis Network.",source:"@site/docs/node/run-your-node/archive-node.md",sourceDirName:"node/run-your-node",slug:"/node/run-your-node/archive-node",permalink:"/node/run-your-node/archive-node",draft:!1,unlisted:!1,editUrl:"https://github.com/oasisprotocol/docs/edit/main/docs/node/run-your-node/archive-node.md",tags:[],version:"current",lastUpdatedAt:1723018842e3,frontMatter:{description:"This page describes how to run an archive node on the Oasis Network."},sidebar:"operators",previous:{title:"Seed Node",permalink:"/node/run-your-node/seed-node"},next:{title:"ParaTime Node",permalink:"/node/run-your-node/paratime-node"}},d={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Configuration (Oasis Core 23 and later)",id:"configuration-oasis-core-23-and-later",level:2},{value:"Configuration (Oasis Core 22 and earlier)",id:"configuration-oasis-core-22-and-earlier",level:2},{value:"Damask",id:"damask",level:4},{value:"Cobalt",id:"cobalt",level:4},{value:"Starting the Oasis Node",id:"starting-the-oasis-node",level:2},{value:"Archive node status",id:"archive-node-status",level:3},{value:"See also",id:"see-also",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",div:"div",h1:"h1",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"archive-node",children:"Archive Node"}),"\n",(0,i.jsx)(n.p,{children:"This guide will cover setting up an archive node for the Oasis Network. Node\nstarted in archive mode only serves existing consensus and runtime states.\nThe node has all unneeded consensus and P2P functionality disabled, therefore\nit will not participate in the network. Archive nodes can be used to access\nhistoric state which is pruned in dump-restore network upgrades."}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.p,{children:["Running an archive node requires a pre-existing ",(0,i.jsx)(n.code,{children:"oasis-node"})," state. If you don't have one,\nyou can download a snapshot of a specific network state ",(0,i.jsx)(n.a,{href:"https://snapshots.oasis.io",children:"here"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"configuration-oasis-core-23-and-later",children:"Configuration (Oasis Core 23 and later)"}),"\n",(0,i.jsxs)(n.p,{children:["Starting from the Oasis Core version 23, the configuration for enabling archive mode has changed.\nUse the ",(0,i.jsx)(n.code,{children:"mode"})," setting:"]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"This setting configures the node to act as an archive node."})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"mode: archive\ncommon:\n    data_dir: /node/data\n    log:\n        format: JSON\n        level:\n            cometbft: info\n            cometbft/context: error\n            default: info\ngenesis:\n    file: /node/etc/genesis.json\nruntime:\n    # Paths to ParaTime bundles for all of the supported ParaTimes.\n    paths:\n        - {{ runtime_orc_path }}\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"Keep all other settings the same as those for a full client node. For example, to serve archived runtime\nstate, the node needs to have the runtime configured and the state present."})}),"\n",(0,i.jsx)(n.h2,{id:"configuration-oasis-core-22-and-earlier",children:"Configuration (Oasis Core 22 and earlier)"}),"\n",(0,i.jsxs)(n.p,{children:["For all pre-Eden networks, such as Damask, the configuration remains the same but requires the\nappropriate version of ",(0,i.jsx)(n.code,{children:"oasis-node"})," and the node state."]}),"\n",(0,i.jsx)(n.h4,{id:"damask",children:"Damask"}),"\n",(0,i.jsxs)(n.p,{children:["To run an archive node for Damask, use ",(0,i.jsx)(n.a,{href:"https://github.com/oasisprotocol/oasis-core/releases/tag/v22.2.12",children:"Oasis Core v22.2.12"})," and the following\nconfiguration:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'datadir: /node/data\n\nlog:\n  level:\n    default: info\n    tendermint: info\n    tendermint/context: error\n  format: JSON\n\ngenesis:\n  file: /node/etc/genesis.json\n\nconsensus:\n  tendermint:\n    mode: archive\n\nruntime:\n  mode: client\n  paths:\n    # Paths to ParaTime bundles for all of the supported ParaTimes.\n    - "{{ runtime_orc_path }}"\n'})}),"\n",(0,i.jsx)(n.h4,{id:"cobalt",children:"Cobalt"}),"\n",(0,i.jsxs)(n.p,{children:["To run an archive node for Cobalt, use ",(0,i.jsx)(n.a,{href:"https://github.com/oasisprotocol/oasis-core/releases/tag/v21.3.14",children:"Oasis Core v21.3.14"})," and the following configuration:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'log:\n  level:\n    default: info\n    tendermint: info\n    tendermint/context: error\n  format: JSON\n\ngenesis:\n  file: /node/etc/genesis.json\n\nconsensus:\n  tendermint:\n    mode: archive\n\nruntime:\n  supported:\n    - "{{ runtime_id }}"\n\n  paths:\n    "{{ runtime_id }}": {{ paratime_binary_path }}\n\nworker:\n  storage:\n    enabled: true\n'})}),"\n",(0,i.jsx)(n.div,{children:(0,i.jsx)(n.p,{children:"Ensure you are using the correct version of oasis-node and the pre-existing state for your specific pre-Eden network."})}),"\n",(0,i.jsx)(n.h2,{id:"starting-the-oasis-node",children:"Starting the Oasis Node"}),"\n",(0,i.jsx)(n.p,{children:"You can start the node by running the following command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"oasis-node --config /node/etc/config.yml\n"})}),"\n",(0,i.jsx)(n.h3,{id:"archive-node-status",children:"Archive node status"}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"The mode field is currently unavailable in the control status output. It will\nbe included in an upcoming release."})}),"\n",(0,i.jsx)(n.p,{children:"To ensure the node is running in archive mode, run the following command:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"oasis-node control status -a unix:/node/data/internal.sock\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Output should report ",(0,i.jsx)(n.code,{children:"archive"})," consensus mode status:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  // other fields omitted ...\n  "mode": "archive",\n  // ...\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"see-also",children:"See also"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"/node/web3#archive-web3-gateway",children:"Archive Web3 Gateway"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>t,x:()=>a});var i=o(6540);const s={},r=i.createContext(s);function t(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);