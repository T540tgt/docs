<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-dapp/sapphire/guide" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Guide | Oasis Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.oasis.io/dapp/sapphire/guide"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Guide | Oasis Documentation"><meta data-rh="true" name="description" content="Guide to creating secure dApps on Sapphire"><meta data-rh="true" property="og:description" content="Guide to creating secure dApps on Sapphire"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docs.oasis.io/dapp/sapphire/guide"><link data-rh="true" rel="alternate" href="https://docs.oasis.io/dapp/sapphire/guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.oasis.io/dapp/sapphire/guide" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.7a5b674c.css">
<script src="/assets/js/runtime~main.cb59dacc.js" defer="defer"></script>
<script src="/assets/js/main.09570b7a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Oasis Docs" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.svg" alt="Oasis Docs" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/general/">Use Oasis</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dapp/">Create dApp</a><a class="navbar__item navbar__link" href="/get-involved/">Get Involved</a><a class="navbar__item navbar__link" href="/node/">Run Node</a><a class="navbar__item navbar__link" href="/paratime/">Build ParaTime</a><a class="navbar__item navbar__link" href="/core/">Develop Core</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oasisprotocol" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub repository" aria-label="GitHub repository"></a><a href="https://oasisprotocol.org/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-www-link" title="Oasis Protocol Foundation website" aria-label="Oasis Protocol Foundation website"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dapp/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/dapp/sapphire/">Sapphire</a><button aria-label="Collapse sidebar category &#x27;Sapphire&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp/sapphire/quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/dapp/sapphire/guide">Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp/sapphire/browser">Browser Support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp/sapphire/authentication">View-Call Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp/sapphire/gasless">Gasless Transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp/sapphire/addresses">Contract Addresses and Deployments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp/sapphire/deployment">Deployment Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dapp/sapphire/security">Security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://api.docs.oasis.io/js/sapphire-paratime" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">TypeScript API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a href="https://api.docs.oasis.io/sol/sapphire-contracts" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK" tabindex="0">Solidity API<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dapp/opl/">Oasis Privacy Layer</a><button aria-label="Expand sidebar category &#x27;Oasis Privacy Layer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dapp/cipher/">Cipher</a><button aria-label="Expand sidebar category &#x27;Cipher&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dapp/emerald/">Emerald</a><button aria-label="Expand sidebar category &#x27;Emerald&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Guide</h1>
<p>This page mainly describes the differences between Sapphire and Ethereum
since there are a number of excellent tutorials on developing for Ethereum.
If you don&#x27;t know where to begin, the <a href="https://hardhat.org/tutorial" target="_blank" rel="noopener noreferrer">Hardhat tutorial</a>, <a href="https://docs.soliditylang.org/en/v0.8.15/solidity-by-example.html" target="_blank" rel="noopener noreferrer">Solidity docs</a>, and
<a href="/dapp/emerald/writing-dapps-on-emerald">Emerald dApp tutorial</a> are great places to start. You can continue following
this guide once you&#x27;ve set up your development environment and have deployed
your contract to a non-confidential EVM network (e.g., Ropsten, Emerald).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="oasis-consensus-layer-and-sapphire-paratime">Oasis Consensus Layer and Sapphire ParaTime<a href="#oasis-consensus-layer-and-sapphire-paratime" class="hash-link" aria-label="Direct link to Oasis Consensus Layer and Sapphire ParaTime" title="Direct link to Oasis Consensus Layer and Sapphire ParaTime">​</a></h2>
<p>The Oasis Network consists of the consensus layer and a number of ParaTimes.
ParaTimes are independent replicated state machines that settle transactions
using the consensus layer (to learn more, check the <a href="/general/oasis-network/">Oasis Network
Overview</a>). Sapphire is a ParaTime which implements the
Ethereum Virtual Machine (EVM).</p>
<p>The minimum and also expected block time in Sapphire is <strong>6 seconds</strong>. Any
Sapphire transaction will require at least this amount of time to be executed,
and probably no more.</p>
<p>ParaTimes, Sapphire included, are not allowed to directly access your tokens
stored in consensus layer accounts. You will need to <em>deposit</em> tokens from your
consensus account to Sapphire. Consult the <a href="/general/manage-tokens/#rose-and-the-paratimes">Manage your
Tokens</a> chapter to learn more.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="testnet-and-mainnet">Testnet and Mainnet<a href="#testnet-and-mainnet" class="hash-link" aria-label="Direct link to Testnet and Mainnet" title="Direct link to Testnet and Mainnet">​</a></h2>
<p>Sapphire is deployed on Testnet and Mainnet chains. Testnet should be
considered unstable software and may also have its state wiped at any time. As
the name implies, only use Testnet for testing unless you&#x27;re testing how
angry your users get when state is wiped.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Never deploy production services on Testnet</div><div class="admonitionContent_BuS1"><p>Because Testnet state can be wiped in the future, you should <strong>never</strong> deploy a
production service on Testnet! Just don&#x27;t do it!</p><p>Also note that while Testnet does use proper TEEs, due to experimental
software and different security parameters, <strong>confidentiality of Sapphire on
Testnet is not guaranteed</strong> -- all transactions and state published on the
Sapphire Testnet should be considered public.</p></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>For testing purposes, visit our <a href="https://faucet.testnet.oasis.io/" target="_blank" rel="noopener noreferrer">Testnet faucet</a> to obtain some TEST which you
can then use on the Sapphire Testnet to pay for gas fees. The faucet supports
sending TEST both to your consensus layer address or to your address inside the
ParaTime.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sapphire-vs-ethereum">Sapphire vs Ethereum<a href="#sapphire-vs-ethereum" class="hash-link" aria-label="Direct link to Sapphire vs Ethereum" title="Direct link to Sapphire vs Ethereum">​</a></h2>
<p>Sapphire is generally compatible with Ethereum, the EVM, and all the user and
developer tooling that you are used to. In addition to confidentiality
features, you get a few extra benefits including the ability to <strong>generate
private entropy</strong>, and <strong>make signatures on-chain</strong>. An example of a dApp that
uses both is an HSM contract that generates an Ethereum wallet and signs
transactions sent to it via transactions.</p>
<p>There are also a few breaking changes compared to Ethereum though, but we think
that you&#x27;ll quickly grasp them:</p>
<ul>
<li><a href="#encrypted-contract-state">Encrypted Contract State</a></li>
<li><a href="#end-to-end-encrypted-transactions-and-calls">End-to-End Encrypted Transactions and Calls</a></li>
<li><a href="#from-address-is-zero-for-unsigned-calls"><code>from</code> Address is Zero for Unsigned Calls</a></li>
<li><a href="#override-receive-and-fallback-when-funding-the-contract">Override <code>receive</code> and <code>fallback</code> when Funding the Contract</a></li>
<li><a href="#instant-finality">Instant Finality</a></li>
</ul>
<p>Read below to learn more about them. Otherwise, Sapphire is like Emerald, a
fast, cheap Ethereum.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="encrypted-contract-state">Encrypted Contract State<a href="#encrypted-contract-state" class="hash-link" aria-label="Direct link to Encrypted Contract State" title="Direct link to Encrypted Contract State">​</a></h3>
<p>The contract state is only visible to the contract that wrote it. With respect
to the contract API, it&#x27;s as if all state variables are declared as <code>private</code>,
but with the further restriction that not even full nodes can read the values.
Public or access-controlled values are provided instead through explicit
getters.</p>
<p>Calling <code>eth_getStorageAt()</code> will return zero.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="end-to-end-encrypted-transactions-and-calls">End-to-End Encrypted Transactions and Calls<a href="#end-to-end-encrypted-transactions-and-calls" class="hash-link" aria-label="Direct link to End-to-End Encrypted Transactions and Calls" title="Direct link to End-to-End Encrypted Transactions and Calls">​</a></h3>
<p>Transactions and calls are end-to-end encrypted into the contract. Only the
caller and the contract can see the data sent to/received from the ParaTime.
This ends up defeating some utility of block explorers, however.</p>
<p>The status of the transaction is public and so are the error code, the revert
message and logs (emitted events).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="from-address-is-zero-for-unsigned-calls"><code>from</code> Address is Zero for Unsigned Calls<a href="#from-address-is-zero-for-unsigned-calls" class="hash-link" aria-label="Direct link to from-address-is-zero-for-unsigned-calls" title="Direct link to from-address-is-zero-for-unsigned-calls">​</a></h3>
<p>The <code>from</code> address using of calls is derived from a signature attached to the
call. Unsigned calls have their sender set to the zero address. This allows
contract authors to write getters that release secrets to authenticated callers
(e.g. by checking the <code>msg.sender</code> value), but without requiring a transaction
to be posted on-chain.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="override-receive-and-fallback-when-funding-the-contract">Override <code>receive</code> and <code>fallback</code> when Funding the Contract<a href="#override-receive-and-fallback-when-funding-the-contract" class="hash-link" aria-label="Direct link to override-receive-and-fallback-when-funding-the-contract" title="Direct link to override-receive-and-fallback-when-funding-the-contract">​</a></h3>
<p>In Ethereum, you can fund a contract by sending Ether along the transaction in
two ways:</p>
<ol>
<li>a transaction must call a <em>payable</em> function in the contract, or</li>
<li>not calling any specific function (i.e. empty <em>calldata</em>). In this case,
the payable <code>receive()</code> and/or <code>fallback()</code> functions need to be defined in
the contract. If no such functions exist, the transaction will revert.</li>
</ol>
<p>The behavior described above is the same in Sapphire when using EVM transactions
to fund a contract.</p>
<p>However, the Oasis Network also uses <a href="/general/manage-tokens/">Oasis-native transactions</a> such as a
deposit to a ParaTime account or a transfer. In this case, <strong>you will be able to
fund the contract&#x27;s account even though the contract may not implement payable
<code>receive()</code> or <code>fallback()</code>!</strong> Or, if these functions do exist, <strong>they will not
be triggered</strong>. You can send such Oasis-native transactions by using the <a href="/general/manage-tokens/cli/">Oasis
CLI</a> for example.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="instant-finality">Instant Finality<a href="#instant-finality" class="hash-link" aria-label="Direct link to Instant Finality" title="Direct link to Instant Finality">​</a></h3>
<p>The Oasis Network is a proof of stake network where 2/3+ of the validator nodes
need to verify each block in order to consider it final. However, in Ethereum
the signatures of those validator nodes can be submitted minutes after the block
is proposed, which makes the block proposal mechanism independent of the
validation, but adds uncertainty if and when will the proposed block actually be
finalized.</p>
<p>In the Oasis Network, the 2/3+ of signatures need to be provided immediately
after the block is proposed and <strong>the network will halt, until the required
number signatures are provided</strong>. This means that you can rest assured that any
validated block is final. As a consequence, the cross-chain bridges are more
responsive yet safe on the Oasis Network.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integrating-sapphire">Integrating Sapphire<a href="#integrating-sapphire" class="hash-link" aria-label="Direct link to Integrating Sapphire" title="Direct link to Integrating Sapphire">​</a></h2>
<p>Once ROSE tokens are <a href="/general/manage-tokens/#rose-and-the-paratimes">deposited into Sapphire</a>, it should
be painless for users to begin using dApps. To achieve this ideal user
experience, we have to modify the dApp a little, but it&#x27;s made simple by our
compatibility library, <a href="https://www.npmjs.com/package/@oasisprotocol/sapphire-paratime" target="_blank" rel="noopener noreferrer">@oasisprotocol/sapphire-paratime</a>.</p>
<p>There are compatibility layers in other languages, which may be found in <a href="https://github.com/oasisprotocol/sapphire-paratime/tree/main/clients" target="_blank" rel="noopener noreferrer">the repo</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="writing-secure-dapps">Writing Secure dApps<a href="#writing-secure-dapps" class="hash-link" aria-label="Direct link to Writing Secure dApps" title="Direct link to Writing Secure dApps">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wallets">Wallets<a href="#wallets" class="hash-link" aria-label="Direct link to Wallets" title="Direct link to Wallets">​</a></h3>
<p>Sapphire is compatible with popular self-custodial wallets including MetaMask,
Ledger, Brave, and so forth. You can also use libraries like Ethers and Viem
to create programmatic wallets. In general, if it generates secp256k1 signatures,
it&#x27;ll work just fine.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="languages--frameworks">Languages &amp; Frameworks<a href="#languages--frameworks" class="hash-link" aria-label="Direct link to Languages &amp; Frameworks" title="Direct link to Languages &amp; Frameworks">​</a></h3>
<p>Sapphire is programmable using any language that targets the EVM, such as Solidity
or Vyper. If you prefer to use an Ethereum framework like Hardhat or Foundry, you
can also use those with Sapphire; all you need to do is set your Web3 gateway URL.
You can find the details of the Oasis Sapphire Web3 endpoints
<a href="/dapp/sapphire/#rpc-endpoints">here</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="transactions--calls">Transactions &amp; Calls<a href="#transactions--calls" class="hash-link" aria-label="Direct link to Transactions &amp; Calls" title="Direct link to Transactions &amp; Calls">​</a></h3>
<p><img decoding="async" loading="lazy" alt="Client, Key Manager, Compute Node diagram" src="/assets/images/client-km-compute-e82d4c5748974134adbf78d76ca7bc03.svg" class="img_ev3q"></p>
<p>The figure above illustrates the flow of a <strong>confidential smart contract
transaction</strong> on Sapphire.</p>
<p>Transactions and calls must be encrypted and signed for maximum security.
The <a href="https://www.npmjs.com/package/@oasisprotocol/sapphire-paratime" target="_blank" rel="noopener noreferrer">@oasisprotocol/sapphire-paratime</a> npm package will make your life
easy. It&#x27;ll handle cryptography and signing for you.</p>
<p>You should be aware that taking actions based on the value of private data may
<strong>leak the private data through side channels</strong> like time spent, gas use and
accessed memory locations. If you need to branch on private data, you should in
most cases ensure that both branches exhibit the same time/gas and storage
patterns.</p>
<p>You can also make <strong>confidential smart contract calls</strong> on Sapphire. If you
use <code>msg.sender</code> for access control in your contract, the call <strong>must be
signed</strong>, otherwise <code>msg.sender</code> will be zeroed. On the other hand, set the
<code>from</code> address to all zeros, if you want to avoid annoying signature popups in
the user&#x27;s wallet for calls that do not need to be signed. The JS library will
do this for you.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Inside the smart contract code, there is no way of knowing whether the
client&#x27;s call data were originally encrypted or not.</p></div></div>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Detailed confidential smart contract transaction flow on Sapphire</summary><div><div class="collapsibleContent_i85q"><p><img decoding="async" loading="lazy" alt="Diagram of the detailed confidential smart contract transaction flow on Sapphire" src="/assets/images/c10l-smart-contract-tx.mmd-1979dfebd7f16fb909380088da1c7be2.svg" width="1087" height="4156" class="img_ev3q"></p></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Detailed confidential smart contract call flow on Sapphire</summary><div><div class="collapsibleContent_i85q"><p><img decoding="async" loading="lazy" alt="Diagram of the detailed confidential smart contract call flow on Sapphire" src="/assets/images/c10l-smart-contract-call.mmd-bba499f12d79733189ed91fd919480b9.svg" width="1087" height="3798" class="img_ev3q"></p></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="contract-state">Contract State<a href="#contract-state" class="hash-link" aria-label="Direct link to Contract State" title="Direct link to Contract State">​</a></h3>
<p>The Sapphire state model is like Ethereum&#x27;s except for all state being encrypted
and not accessible to anyone except the contract. The contract, executing in an
active (attested) Oasis compute node is the only entity that can request its
state encryption key from the Oasis key manager. Both the keys and values of the
items stored in state are encrypted, but the <strong>size of either is not hidden</strong>. Your
app may need to pad state items to a constant length, or use other obfuscation.
Observers may also be able to infer computation based on storage access patterns,
so you may need to obfuscate that, too. See <a href="/dapp/sapphire/security#storage-access-patterns">Security chapter</a> for more
recommendations.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Contract state leaks a fine-grained access pattern</div><div class="admonitionContent_BuS1"><p>Contract state is backed by an encrypted key-value store. However, the trace of
encrypted records is leaked to the compute node. As a concrete example, an ERC-20
token transfer would leak which encrypted record is for the sender&#x27;s account
balance and which is for the receiver&#x27;s account balance. Such a token would be
traceable from sender address to receiver address. Obfuscating the storage access
patterns may be done by using an ORAM implementation.</p></div></div>
<p>Contract state may be made available to third parties through logs/events, or
explicit getters.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="contract-logs">Contract Logs<a href="#contract-logs" class="hash-link" aria-label="Direct link to Contract Logs" title="Direct link to Contract Logs">​</a></h3>
<p>Contract logs/events (e.g., those emitted by the Solidity <code>emit</code> keyword)
are exactly like Ethereum. Data contained in events is <em>not</em> encrypted.
Precompiled contracts are available to help you encrypt data that you can
then pack into an event, however.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Unmodified contracts may leak state through logs</div><div class="admonitionContent_BuS1"><p>Base contracts like those provided by OpenZeppelin often emit logs containing
private information. If you don&#x27;t know they&#x27;re doing that, you might undermine
the confidentiality of your state. As a concrete example, the ERC-20 spec
requires implementers to emit an <code>event Transfer(from, to, amount)</code>, which is
obviously problematic if you&#x27;re writing a confidential token. What you can
do instead is fork that contract and remove the offending emissions.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="contract-verification">Contract Verification<a href="#contract-verification" class="hash-link" aria-label="Direct link to Contract Verification" title="Direct link to Contract Verification">​</a></h2>
<p><a href="https://sourcify.dev/" target="_blank" rel="noopener noreferrer">Sourcify</a> is the preferred service for the <a href="https://ethereum.org/en/developers/docs/smart-contracts/verifying/" target="_blank" rel="noopener noreferrer">verification of smart
contracts</a> deployed on Sapphire. Make sure you have
the <strong>address of each deployed contract</strong> available (your deployment scripts
should report those) and the <strong>contracts JSON metadata file</strong> generated when
compiling contracts (Hardhat stores it inside the <code>artifacts/build-info</code> folder
and names it as a 32-digit hex number). If your project contains multiple
contracts, you will need to verify each contract separately.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Contract deployment encryption</div><div class="admonitionContent_BuS1"><p><strong>Do not deploy your contract with an encrypted contract deployment transaction,
if you want to verify it.</strong> For example, if your <code>hardhat.config.ts</code>
or deployment script contains <code>import &#x27;@oasisprotocol/sapphire-hardhat&#x27;</code> or
<code>import &#x27;@oasisprotocol/sapphire-paratime&#x27;</code> lines at the beginning, you should
comment those out for the deployment.</p><p>Verification services will try to match the contract deployment transaction code
with the one in the provided contract&#x27;s metadata and since the transaction was
encrypted with an ephemeral ParaTime key, the verification service will not be
able to decrypt it. Some services may extract the contract&#x27;s bytecode from the
chain directly by calling <code>eth_getCode</code> RPC, but this will not work correctly
for contracts with immutable variables.</p></div></div>
<p>To verify a contract deployed on Sapphire Mainnet or Testnet:</p>
<ol>
<li>
<p>Visit the <a href="https://sourcify.dev/" target="_blank" rel="noopener noreferrer">Sourcify</a> website and hit the &quot;VERIFY CONTRACT&quot; button.</p>
<p><img decoding="async" loading="lazy" alt="Sourcify website" src="/assets/images/sourcify1-898a49b3519501962fe80f3ba09314b1.png" width="1564" height="979" class="img_ev3q"></p>
</li>
<li>
<p>Upload the contracts JSON metadata file.</p>
<p><img decoding="async" loading="lazy" alt="Sourcify: Upload metadata JSON file" src="/assets/images/sourcify2-d95710724b0373068c2ac0f857e07928.png" width="1564" height="979" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Store your metadata files</div><div class="admonitionContent_BuS1"><p>For production deployments, it is generally a good idea to <strong>archive your
contract metadata JSON file</strong> since it is not only useful for the
verification, but contains a copy of all the source files, produced bytecode,
an ABI, compiler and other relevant contract-related settings that may be
useful in the future. Sourcify will store the metadata file for you and will
even make it available via IPFS, but it is still a good idea to store it
yourself.</p></div></div>
</li>
<li>
<p>Sourcify will decode the metadata and prepare a list of included contracts on
the right. Enter the address of the specific contract and select the &quot;Oasis
Sapphire&quot; or &quot;Oasis Sapphire Testnet&quot; chain for Mainnet or Testnet
accordingly. If your contract assigns any immutable variables in the
constructor, you will also need to correctly fill those out under the &quot;More
Inputs (optional)&quot; panel. Finally, click on the &quot;Verify&quot; button.</p>
<p><img decoding="async" loading="lazy" alt="Sourcify: Verify contract" src="/assets/images/sourcify3-8be00790df0e04f4720273e6cde8a867.png" width="1564" height="2420" class="img_ev3q"></p>
</li>
<li>
<p>If everything goes well, you will get a <em>Perfect match</em> notice and your
contract is now verified. Congratulations!</p>
</li>
</ol>
<p>In case of a <em>Partial match</em>, the contracts metadata JSON differs from the one
used for deployment although the compiled contract bytecode matched. Make sure
the source code <code>.sol</code> file of the contract is the same as the one used during the
deployment (including the comments, variable names and source code file
names) and use the same version of Hardhat and solc compiler.</p>
<p>You can also explore other verification methods on Sourcify by reading the
<a href="https://docs.sourcify.dev/docs/how-to-verify/" target="_blank" rel="noopener noreferrer">official Sourcify contract verification instructions</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="running-a-private-oasis-network-locally">Running a Private Oasis Network Locally<a href="#running-a-private-oasis-network-locally" class="hash-link" aria-label="Direct link to Running a Private Oasis Network Locally" title="Direct link to Running a Private Oasis Network Locally">​</a></h2>
<p>For convenient development and testing of your dApps the Oasis team prepared
the <a href="https://github.com/oasisprotocol/oasis-web3-gateway/pkgs/container/sapphire-localnet" target="_blank" rel="noopener noreferrer">ghcr.io/oasisprotocol/sapphire-localnet</a> Docker image
which brings you a complete Oasis network stack to your desktop. The Localnet
Sapphire instance <strong>mimics confidential transactions</strong>, but it does not run in a
trusted execution environment nor does it require Intel&#x27;s SGX on your computer.
The network is isolated from the Mainnet or Testnet and consists of a:</p>
<ul>
<li>single Oasis validator node with 1-second block time and 30-second epoch,</li>
<li>single Oasis client node,</li>
<li>single compute node running Oasis Sapphire,</li>
<li>single key manager node,</li>
<li>PostgreSQL instance,</li>
<li>Oasis Web3 gateway with transaction indexer and enabled Oasis RPCs,</li>
<li>helper script which populates the account(s) for you.</li>
</ul>
<p>To run the image, execute:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it -p8545:8545 -p8546:8546 ghcr.io/oasisprotocol/sapphire-localnet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After a while, the tool will show you something like this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sapphire-localnet 2024-05-28-git37b7166 (oasis-core: 24.0-gitfb49717, sapphire-paratime: 0.7.3-testnet, oasis-web3-gateway: 5.1.0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Starting oasis-net-runner with sapphire...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Waiting for Postgres to start...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Waiting for Oasis node to start.....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Starting oasis-web3-gateway...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Bootstrapping network (this might take a minute)...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Waiting for key manager......</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Populating accounts...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Available Accounts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(0) 0x41b0C13e747F8Cb1c4E980712504437cb1792327 (10000 TEST)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(1) 0xa521f94f8a38b1d027D526017EB229327B9D6cA0 (10000 TEST)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(2) 0x1e0f8369215D6C5Af5E14eD6A0D6ae7372776A79 (10000 TEST)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(3) 0xB60cA28B491747a27C057AdBF3E71F3CCC52332C (10000 TEST)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(4) 0x88D7d924e521a6d07008a373D5b33281148ffEDc (10000 TEST)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Keys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(0) 0x617346c545d62b8213ea907acf1b570a7405683e2c6dcaf963fc21fd677e0c56</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(1) 0xf82d6e09208b0bd44a397f7e73b05c564e6c9f70b151ee7677e2bb8d6ce5d882</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(2) 0xeb2f21d20086f3dd6bfe7184dad1cb8b0fb802f27b1334e836a19eda0a43a1c2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(3) 0x82b0203d6063992b1052004b90411c45d4f3afab696346f006e74c6abd8f855e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(4) 0x7179c6e1add3a2993822653b9c98fe606f47fb6d4c0d0d81b31b067cf6bb5f83</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HD Wallet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">==================</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Mnemonic:       coach genre beach child crunch champion tell adult critic peace canoe stable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Base HD Path:   m/44&#x27;/60&#x27;/0&#x27;/0/%d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING: The chain is running in ephemeral mode. State will be lost after restart!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Listening on http://localhost:8545 and ws://localhost:8546. Chain ID: 0x5afd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Container start-up took 66 seconds, node log level is set to warn.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Those familiar with local dApp environments will find the output above similar
to <code>geth --dev</code> or <code>ganache-cli</code> commands or the <code>geth-dev-assistant</code> npm
package. <a href="https://github.com/oasisprotocol/oasis-web3-gateway/pkgs/container/sapphire-localnet" target="_blank" rel="noopener noreferrer">sapphire-localnet</a> will spin up a private Oasis Network locally,
generate and populate test accounts and make the following Web3 endpoints
available for you to use:</p>
<ul>
<li><code>http://localhost:8545</code></li>
<li><code>ws://localhost:8546</code></li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>If you prefer using the same mnemonics each time (e.g. for testing purposes)
or to populate just a single account, use <code>-to</code> flag and pass the mnemonics or
the wallet addresses. By passing the <code>-test-mnemonic</code> flag you can fund the
standard test accounts provided by the <code>hardhat node</code> commmand and that are
typically used for solidity unit tests.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it -p8545:8545 -p8546:8546 ghcr.io/oasisprotocol/sapphire-localnet -to &quot;bench remain brave curve frozen verify dream margin alarm world repair innocent&quot; -n3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it -p8545:8545 -p8546:8546 ghcr.io/oasisprotocol/sapphire-localnet -to &quot;0x75eCF0d4496C2f10e4e9aF3D4d174576Ee9010E2,0xbDA5747bFD65F08deb54cb465eB87D40e51B197E&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it -p8545:8545 -p8546:8546 ghcr.io/oasisprotocol/sapphire-localnet -test-mnemonic</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Running on Apple M chips</div><div class="admonitionContent_BuS1"><p>There is currently no <code>arm64</code> build available for M Macs, so you will need to
force the docker image to use the <code>linux/x86_64</code> platform, like this:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it -p8545:8545 -p8546:8546 --platform linux/x86_64 ghcr.io/oasisprotocol/sapphire-localnet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p><a href="https://github.com/oasisprotocol/oasis-web3-gateway/pkgs/container/sapphire-localnet" target="_blank" rel="noopener noreferrer">sapphire-localnet</a> runs in ephemeral mode. Any smart contract and wallet balance
will be lost after you quit the Docker container!</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="see-also">See also<a href="#see-also" class="hash-link" aria-label="Direct link to See also" title="Direct link to See also">​</a></h2>
<a class="card padding--lg cardContainer_fWXF" href="/node/run-your-node/paratime-client-node"><h2 class="text--truncate cardTitle_rnsV" title="ParaTime Client Node">📄️<!-- --> <!-- -->ParaTime Client Node</h2><p class="text--truncate cardDescription_PWke" title="These instructions are for setting up a ParaTime client node which only observes ParaTime activity and can submit transactions. If you want to run a ParaTime node instead, see the instructions for running a ParaTime node. Similarly, if you want to run a validator or a non-validator node instead, see the instructions for running a validator node or instructions for running a non-validator node.">These instructions are for setting up a ParaTime client node which only observes ParaTime activity and can submit transactions. If you want to run a ParaTime node instead, see the instructions for running a ParaTime node. Similarly, if you want to run a validator or a non-validator node instead, see the instructions for running a validator node or instructions for running a non-validator node.</p></a>
<a class="card padding--lg cardContainer_fWXF" href="/node/web3"><h2 class="text--truncate cardTitle_rnsV" title="Web3 Gateway">📄️<!-- --> <!-- -->Web3 Gateway</h2><p class="text--truncate cardDescription_PWke" title="Web3 gateway for Emerald and Sapphire ParaTimes">Web3 gateway for Emerald and Sapphire ParaTimes</p></a></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/oasisprotocol/sapphire-paratime/edit/main/docs/guide.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-08-07T08:20:42.000Z" itemprop="dateModified">Aug 7, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/dapp/sapphire/quickstart"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Quickstart</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/dapp/sapphire/browser"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Browser Support</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#oasis-consensus-layer-and-sapphire-paratime" class="table-of-contents__link toc-highlight">Oasis Consensus Layer and Sapphire ParaTime</a></li><li><a href="#testnet-and-mainnet" class="table-of-contents__link toc-highlight">Testnet and Mainnet</a></li><li><a href="#sapphire-vs-ethereum" class="table-of-contents__link toc-highlight">Sapphire vs Ethereum</a><ul><li><a href="#encrypted-contract-state" class="table-of-contents__link toc-highlight">Encrypted Contract State</a></li><li><a href="#end-to-end-encrypted-transactions-and-calls" class="table-of-contents__link toc-highlight">End-to-End Encrypted Transactions and Calls</a></li><li><a href="#from-address-is-zero-for-unsigned-calls" class="table-of-contents__link toc-highlight"><code>from</code> Address is Zero for Unsigned Calls</a></li><li><a href="#override-receive-and-fallback-when-funding-the-contract" class="table-of-contents__link toc-highlight">Override <code>receive</code> and <code>fallback</code> when Funding the Contract</a></li><li><a href="#instant-finality" class="table-of-contents__link toc-highlight">Instant Finality</a></li></ul></li><li><a href="#integrating-sapphire" class="table-of-contents__link toc-highlight">Integrating Sapphire</a></li><li><a href="#writing-secure-dapps" class="table-of-contents__link toc-highlight">Writing Secure dApps</a><ul><li><a href="#wallets" class="table-of-contents__link toc-highlight">Wallets</a></li><li><a href="#languages--frameworks" class="table-of-contents__link toc-highlight">Languages &amp; Frameworks</a></li><li><a href="#transactions--calls" class="table-of-contents__link toc-highlight">Transactions &amp; Calls</a></li><li><a href="#contract-state" class="table-of-contents__link toc-highlight">Contract State</a></li><li><a href="#contract-logs" class="table-of-contents__link toc-highlight">Contract Logs</a></li></ul></li><li><a href="#contract-verification" class="table-of-contents__link toc-highlight">Contract Verification</a></li><li><a href="#running-a-private-oasis-network-locally" class="table-of-contents__link toc-highlight">Running a Private Oasis Network Locally</a></li><li><a href="#see-also" class="table-of-contents__link toc-highlight">See also</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">General</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://explorer.oasis.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Explorer</a></li><li class="footer__item"><a href="https://wallet.oasis.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wallet</a></li><li class="footer__item"><a href="https://github.com/oasisprotocol/cli" target="_blank" rel="noopener noreferrer" class="footer__link-item">CLI</a></li><li class="footer__item"><a href="https://status.oasis.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Status</a></li></ul></div><div class="col footer__col"><div class="footer__title">dApp</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://faucet.testnet.oasis.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Testnet Faucet</a></li><li class="footer__item"><a href="https://playground.oasis.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Playground</a></li><li class="footer__item"><a href="https://api.docs.oasis.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">API</a></li></ul></div><div class="col footer__col"><div class="footer__title">Node</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/node/mainnet/">Mainnet</a></li><li class="footer__item"><a class="footer__link-item" href="/node/testnet/">Testnet</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://oasis.io/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://t.me/oasisprotocolcommunity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC35UFPcZ2F1wjPxhPrSsESQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/oasisprotocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
<p xmlns:cc="http://creativecommons.org/ns#">Copyright © 2024
by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://oasisprotocol.org">
Oasis Protocol Foundation</a>.
Unless otherwise specified, all text and images on this website are licensed
under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
CC BY 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="/img/cc.svg"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="/img/by.svg"></a>.
This does not include the Oasis software and the code examples, both of which are
licensed under <a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
Apache 2.0</a>. Built with &#x2665; and Docusaurus.</p></div></div></div></footer></div>
</body>
</html>